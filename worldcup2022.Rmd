---
title: "World Cup 2022"
author: "Sean Li, Brian Janger, Aaditya Warrier, Christina Yoh"
date: '2022-12-03'
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Methodology: 
Using historical data and group stage matches individual match up to the final 16 (because we know these matchups will occur) 
Based on this data, we will calculate win probabilities, loss probabilities, and expected score 
Based on individual matches in the group stage up to round of 16, we will calculate who wins top of their group/2nd etc. 

Model: 
Use a probabilistic model, because sports betters want to know probabilities 
Poisson GLM, can use lasso
Monte Carlo 


## FINAL WRITEUP

```{r}
library(tidyverse)
library(DescTools)
data("d.countries")
int_matches <- read_csv("data/international_matches.csv")
qatar_teams <- read_delim("data/Qatar2022-teams.csv", delim = ";")
matches_sched <- read_delim("data/matchs-schedule.csv", delim = ";")
```


```{r}
library(glmnet)
glmnet()
```



```{r}
library(rvest)
years <- c(seq(1990,2022,4))
result = list()
for (year in years) {
    url <- paste0("http://en.wikipedia.org/wiki/", year, "_FIFA_World_Cup_squads")
    temp <- read_html(url)
    tables <- temp %>%
      html_table() %>%
      list() %>%
      .[[1]]
    countries <- temp %>%
      html_elements("h3 .mw-headline") %>%
      html_text()
    names(tables) <- countries
    tables <- tables[names(tables) %in% d.countries$name]
    result <- append(result, list(tables))
}   
names(result) <- years

result$`1990`
```


